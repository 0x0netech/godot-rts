[gd_scene load_steps=24 format=3 uid="uid://doitvquurtufi"]

[ext_resource type="Script" path="res://source/match/Match.gd" id="1_1555u"]
[ext_resource type="Script" path="res://source/match/IsometricCamera3D.gd" id="1_qb2ry"]
[ext_resource type="Script" path="res://source/model/PlayerSettings.gd" id="2_issh2"]
[ext_resource type="Script" path="res://source/model/MatchSettings.gd" id="3_k87ed"]
[ext_resource type="Script" path="res://source/match/FogOfWar.gd" id="5_eb52t"]
[ext_resource type="Script" path="res://source/match/DummyMovingUnit.gd" id="5_gnrre"]
[ext_resource type="PackedScene" uid="uid://ct0ejt0trkhrf" path="res://source/match/units/CommandCenter.tscn" id="5_ulpug"]
[ext_resource type="Shader" path="res://source/shaders/3d/simple_fog_of_war.gdshader" id="6_bxic7"]
[ext_resource type="PackedScene" uid="uid://clbjgy724q2si" path="res://source/generic-scenes-and-nodes/2d/DynamicCircle2D.tscn" id="6_ux0ef"]
[ext_resource type="PackedScene" uid="uid://fhjyrjmlo6wf" path="res://source/match/debug/GodModeHud.tscn" id="10_p6gno"]

[sub_resource type="Resource" id="Resource_aehri"]
script = ExtResource("2_issh2")
color = Color(0, 0, 1, 1)

[sub_resource type="Resource" id="Resource_ohrdq"]
script = ExtResource("2_issh2")
color = Color(1, 0, 0, 1)

[sub_resource type="Resource" id="Resource_frabv"]
script = ExtResource("3_k87ed")
players = [SubResource("Resource_aehri"), SubResource("Resource_ohrdq")]
controlled_player = 0

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_ysb0j"]

[sub_resource type="Sky" id="Sky_kunr4"]
sky_material = SubResource("ProceduralSkyMaterial_ysb0j")

[sub_resource type="Environment" id="Environment_qxcnu"]
background_mode = 2
sky = SubResource("Sky_kunr4")
ambient_light_color = Color(1, 1, 1, 1)

[sub_resource type="Curve3D" id="Curve3D_h350p"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, 30, 0, 30, 0, 0, 0, 0, 0, 0, 70, 0, 30, 0, 0, 0, 0, 0, 0, 70, 0, 70, 0, 0, 0, 0, 0, 0, 30, 0, 70, 0, 0, 0, 0, 0, 0, 30, 0, 30),
"tilts": PackedFloat32Array(0, 0, 0, 0, 0)
}
point_count = 5

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_1na00"]
albedo_color = Color(1, 0.396078, 0.298039, 1)

[sub_resource type="PlaneMesh" id="PlaneMesh_5wwb3"]
material = SubResource("StandardMaterial3D_1na00")
size = Vector2(100, 100)

[sub_resource type="BoxMesh" id="BoxMesh_qv7qt"]
size = Vector3(1, 4, 1)

[sub_resource type="ViewportTexture" id="ViewportTexture_rm132"]
viewport_path = NodePath("FogOfWar/CombinedViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_5rcuq"]
resource_local_to_scene = true
render_priority = 1
shader = ExtResource("6_bxic7")
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/texture_units_per_world_unit = null
shader_parameter/debug_texture_view = false
shader_parameter/world_visibility_texture = SubResource("ViewportTexture_rm132")

[sub_resource type="QuadMesh" id="QuadMesh_xttrh"]
flip_faces = true
size = Vector2(2, 2)

[node name="Match" type="Node3D"]
script = ExtResource("1_1555u")
settings = SubResource("Resource_frabv")

[node name="IsometricCamera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.866025, 0.5, 0, -0.5, 0.866025, 49.5996, 12.4465, 65.9216)
projection = 1
current = true
size = 20.0
script = ExtResource("1_qb2ry")
size_max = 60
bounding_planes = [Plane(1, 0, 0, 0), Plane(-1, 0, 0, -100), Plane(0, 0, 1, 0), Plane(0, 0, -1, -100)]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.226651, 0.763299, -0.604983, 0, 0.621148, 0.783694, 0.973976, 0.177625, -0.140784, 0, 38.7614, 0)
shadow_enabled = true
shadow_blur = 0.06
directional_shadow_mode = 1
directional_shadow_split_1 = 0.009
directional_shadow_pancake_size = 1024.0

[node name="DummyContent" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="DummyContent"]
environment = SubResource("Environment_qxcnu")

[node name="Path3D" type="Path3D" parent="DummyContent"]
curve = SubResource("Curve3D_h350p")

[node name="DummyMovingUnit" type="PathFollow3D" parent="DummyContent/Path3D"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 30, 0, 30)
script = ExtResource("5_gnrre")

[node name="CommandCenter" parent="DummyContent/Path3D/DummyMovingUnit" groups=["units"] instance=ExtResource("5_ulpug")]

[node name="Map" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 50, 0, 50)

[node name="Meshes" type="Node3D" parent="Map"]

[node name="MeshInstance3D" type="MeshInstance3D" parent="Map/Meshes"]
mesh = SubResource("PlaneMesh_5wwb3")
skeleton = NodePath("../../../DummyContent")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="Map/Meshes"]
transform = Transform3D(0.7979, 0, 0.60279, 0, 1, 0, -0.60279, 0, 0.7979, -4.79884, 0, -3.44205)
mesh = SubResource("BoxMesh_qv7qt")
skeleton = NodePath("../../../DummyContent")

[node name="MeshInstance3D3" type="MeshInstance3D" parent="Map/Meshes"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.36871, 0, -4.30402)
mesh = SubResource("BoxMesh_qv7qt")
skeleton = NodePath("../../../DummyContent")

[node name="MeshInstance3D4" type="MeshInstance3D" parent="Map/Meshes"]
transform = Transform3D(0.864134, 0, -0.503261, 0, 1, 0, 0.503261, 0, 0.864134, -2.42462, 0, 3.55337)
mesh = SubResource("BoxMesh_qv7qt")
skeleton = NodePath("../../../DummyContent")

[node name="SpawnPoints" type="Node3D" parent="Map"]

[node name="Marker3D" type="Marker3D" parent="Map/SpawnPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -38.3571, 0, -38.92)

[node name="Marker3D2" type="Marker3D" parent="Map/SpawnPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 40.9382, 0, -40.4288)

[node name="Marker3D3" type="Marker3D" parent="Map/SpawnPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 41.1455, 0, 42.1901)

[node name="Marker3D4" type="Marker3D" parent="Map/SpawnPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -37.679, 0, 41.4663)

[node name="FogOfWar" type="Node3D" parent="."]
script = ExtResource("5_eb52t")

[node name="CombinedViewport" type="SubViewport" parent="FogOfWar"]
disable_3d = true
handle_input_locally = false
size = Vector2i(200, 200)
render_target_update_mode = 4

[node name="Background" type="ColorRect" parent="FogOfWar/CombinedViewport"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="FogViewportContainer" type="SubViewportContainer" parent="FogOfWar/CombinedViewport"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="FogViewport" type="SubViewport" parent="FogOfWar/CombinedViewport/FogViewportContainer"]
disable_3d = true
transparent_bg = true
handle_input_locally = false
size = Vector2i(200, 200)
render_target_clear_mode = 2
render_target_update_mode = 4

[node name="EditorOnlyCircle" parent="FogOfWar/CombinedViewport" instance=ExtResource("6_ux0ef")]
position = Vector2(100, 100)
radius = 20

[node name="Revealer" type="ColorRect" parent="FogOfWar/CombinedViewport"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="ScreenOverlay" type="MeshInstance3D" parent="FogOfWar"]
material_override = SubResource("ShaderMaterial_5rcuq")
cast_shadow = 0
extra_cull_margin = 16384.0
mesh = SubResource("QuadMesh_xttrh")

[node name="HUD" type="CanvasLayer" parent="."]

[node name="MarginContainer" type="MarginContainer" parent="HUD"]
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -40.0
offset_top = -40.0
grow_horizontal = 0
grow_vertical = 0
theme_override_constants/margin_right = 5
theme_override_constants/margin_bottom = 5

[node name="Minimap" type="PanelContainer" parent="HUD/MarginContainer"]
layout_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="HUD/MarginContainer/Minimap"]
layout_mode = 2
theme_override_constants/margin_left = 5
theme_override_constants/margin_top = 5
theme_override_constants/margin_right = 5
theme_override_constants/margin_bottom = 5

[node name="TextureRect" type="TextureRect" parent="HUD/MarginContainer/Minimap/MarginContainer"]
custom_minimum_size = Vector2(200, 200)
layout_mode = 2
texture = SubResource("ViewportTexture_rm132")
ignore_texture_size = true
stretch_mode = 5

[node name="GodModeHUD" parent="." instance=ExtResource("10_p6gno")]
